window.aframedc=function(t){function e(i){if(a[i])return a[i].exports;var n=a[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var a={};return e.m=t,e.c=a,e.i=function(t){return t},e.d=function(t,a,i){e.o(t,a)||Object.defineProperty(t,a,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=13)}([function(t,e){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("title",{schema:{caption:{default:"",type:"string"},width:{default:7,type:"number"}},multiple:!1,update:function(t){var e,a=this.data;e=this.el;var i=a.width;e.setAttribute("text",{color:"#000000",side:"double",value:a.caption,align:"center",width:i,wrapCount:30})},remove:function(){},pause:function(){},play:function(){}})},function(t,e){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("aframe-grid",{schema:{height:{default:1},width:{default:1},ysteps:{default:4},xsteps:{default:4}},multiple:!1,init:function(){},update:function(t){for(var e=this.data,a=new THREE.LineBasicMaterial({color:0,linewidth:1}),i=e.height/e.ysteps,n=new THREE.Object3D,r=0;r<e.ysteps+1;r++)n.add(function(t){var i=new THREE.Geometry;i.vertices.push(new THREE.Vector3(-.2,0,0),new THREE.Vector3(e.width,0,0));var n=new THREE.Line(i,a);return n.position.set(0,t,0),n}(r*i));for(var d=e.width/e.xsteps,r=0;r<e.xsteps+1;r++)n.add(function(t){var i=new THREE.Geometry;i.vertices.push(new THREE.Vector3(0,-.2,0),new THREE.Vector3(0,e.height,0));var n=new THREE.Line(i,a);return n.position.set(t,0,0),n}(r*d));this.el.setObject3D("group",n)},remove:function(){this.el.removeObject3D("group")},pause:function(){},play:function(){}})},function(t,e){t.exports=function(){return{onDataLoaded:function(t){console.log(this.name+": Data Loaded!"),this.reload=!0,t.target.components[this.name].update(this.data)},default_init:function(t){this.name,this.loaded=!1,this.el.addEventListener("data-loaded",this.onDataLoaded.bind(this))},default_update:function(t){if(this.el._data&&this.el._data.length>0||this.el._group)if(this.reload){for(;this.el.firstChild;)this.el.firstChild.parentNode.removeChild(this.el.firstChild);this.initChart(),this.reload=!1,this.el.setAttribute("visible",!0)}else{var e=AFRAME.utils.diff(t,this.data);if(""!==e.title){var a=this.el.querySelector("[title]");a&&a.setAttribute("title","caption",e.title)}}},addEvents:function(){for(var t=function(t){n(this,t),r(t)},e=function(t){a(t),i(t)},a=function(t){t.setAttribute("color",t._partData.origin_color)},i=function(t){var e=t.parentElement,a=e.querySelector("#tooltip");a&&e.removeChild(a)},n=function(t,e){var a;a=document.createElement("a-entity");var i=Number.parseInt(e._partData.origin_color.replace("#","0x"))-1315860;i="#"+("000000"+i.toString(16)).slice(-6),a.setAttribute("text",{color:"#000000",side:"double",value:t._tooltip?t._tooltip(e.data):e._partData.name,width:6,wrapCount:30});var n={x:e._partData.position.x+3,y:e._partData.position.y,z:e._partData.position.z};a.id="tooltip",a.setAttribute("position",n),e.parentElement.appendChild(a)},r=function(t){var e=t,a=e.getObject3D("mesh").material.color.getHex(),i=16777215^a;e.setAttribute("color","#"+("000000"+i.toString(16)).slice(-6))},d=0;d<this.el.children.length;d++)!function(a,i){i.addEventListener("mouseenter",t.bind(a,i)),i.addEventListener("mouseleave",e.bind(a,i))}(this.el,this.el.children[d])},addTitle:function(){var t=document.createElement("a-entity");t.setAttribute("title",{caption:this.data.title,width:Math.max(this.data.width/2,6)}),t.setAttribute("position",{x:this.data.width/2,y:this.data.height+1,z:0}),this.el.appendChild(t)}}}()},function(t,e){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("aframe-gridxz",{schema:{width:{default:1},depth:{default:1},xsteps:{default:4},zsteps:{default:4}},update:function(){for(var t=this.data,e=new THREE.LineBasicMaterial({color:0,linewidth:1}),a=new THREE.Object3D,i=t.width/t.xsteps,n=0;n<t.xsteps+1;n++)a.add(function(a){var i=new THREE.Geometry;i.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,-t.depth));var n=new THREE.Line(i,e);return n.position.set(a,0,0),n}(n*i));for(var r=t.depth/t.zsteps,n=0;n<t.zsteps+1;n++)a.add(function(a){var i=new THREE.Geometry;i.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(t.width,0,0));var n=new THREE.Line(i,e);return n.position.set(0,0,-a),n}(n*r));this.el.setObject3D("group",a)},remove:function(){this.el.removeObject3D("group")}})},function(t,e){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("aframe-gridyz",{schema:{height:{default:1},depth:{default:1},zsteps:{default:4},ysteps:{default:4}},update:function(){for(var t=this.data,e=new THREE.LineBasicMaterial({color:0,linewidth:1}),a=new THREE.Object3D,i=t.depth/t.zsteps,n=0;n<t.zsteps+1;n++)a.add(function(a){var i=new THREE.Geometry;i.vertices.push(new THREE.Vector3(0,-.2,0),new THREE.Vector3(0,t.height,0));var n=new THREE.Line(i,e);return n.position.set(0,0,-a),n}(n*i));for(var r=t.height/t.ysteps,n=0;n<t.ysteps+1;n++)a.add(function(a){var i=new THREE.Geometry;i.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,-t.depth));var n=new THREE.Line(i,e);return n.position.set(0,a,0),n}(n*r));this.el.setObject3D("group",a)},remove:function(){this.el.removeObject3D("group")}})},function(t,e,a){a(1),a(3),a(4),a(0);var i=a(2);if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("barchart3d",{schema:{gridson:{default:!0},xsteps:{default:5},ysteps:{default:5},zsteps:{default:5},width:{default:10},height:{default:10},depth:{default:.5},color:{default:"#00FF00"},title:{default:""}},onDataLoaded:i.onDataLoaded,update:i.default_update,multiple:!1,init:i.default_init,update:i.default_update,initChart:function(){var t=this.el,e=this.data;if(t._data&&0!==t._data.length||t._group){var a;t._data&&t._data.length>0?a=t._data:t._group&&(a=t._group.all(),a=t._transformFunc(a,t._colors));var i=function(t){for(var e=[],a=[],i=0;i<t.length;i++)-1===e.indexOf(t[i].key1)&&e.push(t[i].key1),-1===a.indexOf(t[i].key2)&&a.push(t[i].key2);return{keysOne:e,keysTwo:a}}(a);this._datakeys=i,BAR_WIDTH=e.width/i.keysOne.length,BAR_DEPTH=e.depth/i.keysTwo.length,MAX_HEIGHT=e.height;var n,r,d=Math.max.apply(null,a.map(function(t){return t.value}));document.createElement("a-entity"),n=BAR_WIDTH/2,r=0;for(var s=0,o=0;o<i.keysOne.length;o++){for(var l=0,h=0;h<i.keysTwo.length;h++){if(0!==a[s].value){var u=a[s].value/d*MAX_HEIGHT,c=function(t,e){return e/2+t}(r,u),p=document.createElement("a-box"),f=t._colors.find(function(t){return t.key===a[s].key2}).value,m=-BAR_DEPTH*(l+.5),v={x:n,y:c,z:m};p.setAttribute("width",BAR_WIDTH),p.setAttribute("height",u),p.setAttribute("depth",BAR_DEPTH),p.setAttribute("color",f),p.setAttribute("position",v);var g=a[o].value;t._valueHandler&&(g=t._valueHandler(a[s]));var _=a[o].key1;t._keyHandler&&(_=t._keyHandler(a[s]));var y={name:"key:"+_+" value:"+g,data:{key1:a[o].key1,key2:a[o].key2,value:a[o].value},position:{x:v.x,y:MAX_HEIGHT+.25,z:v.z},origin_color:f};p._partData=y,t.appendChild(p);var A=function(t,e){if(t.el._dimension){var a=t.el._dimension;a.filterAll(null),a=a.filter(e.data.key);var i;if(t.el._dashboard?i=t.el._dashboard:t.el._panel&&(i=t.el._panel._dashboard),i)for(var n=i.allCharts(),r=0;r<n.length;r++)n[r]!==t.el&&n[r]._group&&n[r].emit("data-loaded");else for(var d=t.el.parentElement.children,r=0;r<d.length;r++)d[r]!==t.el&&d[r]._group&&d[r].emit("data-loaded");t.el.emit("filtered",{element:e})}},E=A.bind(null,this,p._partData);p.addEventListener("click",E)}s++,l++}n+=BAR_WIDTH}this.addEvents();for(var b=this.addYLabels(),w=0;w<b.length;w++)t.appendChild(b[w]);for(var T=this.addZLabels(),w=0;w<T.length;w++)t.appendChild(T[w]);e.gridson&&this.addGrid(),""!==e.title&&this.addTitle()}},addGrid:function(){var t=document.createElement("a-entity");t.setAttribute("aframe-grid",{height:this.data.height,width:this.data.width,ysteps:this.data.ysteps,xsteps:this.data.xsteps}),t.setAttribute("position",{x:0,y:0,z:-this.data.depth}),this.el.appendChild(t);var e=document.createElement("a-entity");e.setAttribute("aframe-gridyz",{height:this.data.height,depth:this.data.depth,ysteps:this.data.ysteps,zsteps:this._datakeys.keysTwo.length});var a=document.createElement("a-entity");a.setAttribute("aframe-gridxz",{width:this.data.width,depth:this.data.depth,xsteps:this.data.xsteps,zsteps:this._datakeys.keysTwo.length}),this.el.appendChild(e),this.el.appendChild(a)},addTitle:i.addTitle,addEvents:i.addEvents,addYLabels:function(){var t,e;this.el,e=this.el._data?this.el._data:this.el._group.top(1/0),t=Math.max.apply(null,e.map(function(t){return t.value})),this._datakeys.keysOne.length;for(var a=t/this.data.ysteps,i=this.data.height/this.data.ysteps,n=[],r=0;r<this.data.ysteps+1;r++)n.push(function(t,e,a){var i=document.createElement("a-entity");TEXT_WIDTH=6;var n=e;i.setAttribute("text",{color:"#000000",side:"double",value:a.toFixed(2),width:TEXT_WIDTH,wrapCount:30,align:"center"});var r={x:-.7,y:n,z:-t.data.depth};return i.setAttribute("position",r),i}(this,r*i,r*a));return n},addZLabels:function(){for(var t=this.data.depth/this._datakeys.keysTwo.length,e=[],a=0;a<this._datakeys.keysTwo.length;a++)e.push(function(t,e,a){var i=document.createElement("a-entity");TEXT_WIDTH=6;var n=-1*(TEXT_WIDTH/2+.7),r=-e,d=t.el._colors.find(function(t){return t.key===a}).value;i.setAttribute("text",{color:d,side:"double",value:a,width:TEXT_WIDTH,wrapCount:30,align:"right"});var s={x:n,y:0,z:r};return i.setAttribute("position",s),i}(this,a*t+t/2,this._datakeys.keysTwo[a]));return e},remove:function(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild);this.el.innerHTML="",this.el.removeEventListener("data-loaded",this.onDataLoaded.bind(this))},pause:function(){},play:function(){}})},function(t,e,a){a(1),a(0);var i=a(2);if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("barchart",{schema:{gridson:{default:!0},xsteps:{default:5},ysteps:{default:5},width:{default:10},height:{default:10},depth:{default:.5},color:{default:"#00FF00"},title:{default:""}},onDataLoaded:i.onDataLoaded,init:i.default_init,update:i.default_update,initChart:function(){var t=this.el,e=this.data;if(t._data&&0!==t._data.length||t._group){var a,i=function(){var t,e=[];t=Math.max.apply(null,arguments);for(var a=0;a<arguments.length;a++)e.push(arguments[a]/t);return e};t._data&&t._data.length>0?a=t._data:t._group&&(a=t._group.all());var n=a.map(function(e){return t._valueHandler?t._valueHandler(e):e.value});n=i.apply(null,n),BAR_WIDTH=e.width/n.length,BAR_DEPTH=e.depth,MAX_HEIGHT=e.height,COLORS=["#2338D9","#23A2D9","#23D978","#BAD923","#D923D3"];var r,d,s;document.createElement("a-entity"),r=BAR_WIDTH/2,d=0,s=e.depth/2;for(var o=0;o<n.length;o++){var l=n[o]*MAX_HEIGHT,h=function(t,e){return e/2+t}(d,l),u=document.createElement("a-box"),c=e.color||COLORS[o%COLORS.length],p={x:r,y:h,z:0};u.setAttribute("width",BAR_WIDTH),u.setAttribute("height",l),u.setAttribute("depth",BAR_DEPTH),u.setAttribute("color",c),u.setAttribute("position",p),r+=BAR_WIDTH;var f=a[o].value;t._valueHandler&&(f=t._valueHandler(a[o]));var m=a[o].key;t._keyHandler&&(m=t._keyHandler(a[o]));var v={name:"key:"+m+" value:"+f,data:{key:a[o].key,value:f},position:{x:p.x,y:d+MAX_HEIGHT+.25,z:p.z+s},origin_color:c};u._partData=v,t.appendChild(u);var g=function(t,e){if(t.el._dimension){var a=t.el._dimension;a.filterAll(null),a=a.filter(e.data.key);var i;if(t.el._dashboard?i=t.el._dashboard:t.el._panel&&(i=t.el._panel._dashboard),i)for(var n=i.allCharts(),r=0;r<n.length;r++)n[r]!==t.el&&n[r]._group&&n[r].emit("data-loaded");else for(var d=t.el.parentElement.children,r=0;r<d.length;r++)d[r]!==t.el&&d[r]._group&&d[r].emit("data-loaded");t.el.emit("filtered",{element:e})}},_=g.bind(null,this,u._partData);u.addEventListener("click",_)}this.addEvents();for(var y=this.addYLabels(),A=0;A<y.length;A++)t.appendChild(y[A]);e.gridson&&this.addGrid(),""!==e.title&&this.addTitle()}},addGrid:function(t){var e=document.createElement("a-entity");e.setAttribute("aframe-grid",{height:this.data.height,width:this.data.width,ysteps:this.data.ysteps,xsteps:this.data.xsteps}),e.setAttribute("position",{x:0,y:0,z:-this.data.depth/2}),this.el.appendChild(e)},addTitle:i.addTitle,addEvents:i.addEvents,addYLabels:function(){var t,e,a=this.el;e=this.el._data?this.el._data:this.el._group.top(1/0);var i=e.map(function(t){return a._valueHandler?a._valueHandler(t):t.value});t=Math.max.apply(null,i),i.length;for(var n=t/this.data.ysteps,r=this.data.height/this.data.ysteps,d=[],s=0;s<this.data.ysteps+1;s++)d.push(function(t,e,a){var i=document.createElement("a-entity");TEXT_WIDTH=6;var n=e;i.setAttribute("text",{color:"#000000",side:"double",value:a.toFixed(2),width:TEXT_WIDTH,wrapCount:30,align:"center"});var r={x:-.7,y:n,z:-t.data.depth/2};return i.setAttribute("position",r),i}(this,s*r,s*n));return d},remove:function(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild);this.el.innerHTML="",this.el.removeEventListener("data-loaded",this.onDataLoaded.bind(this))}})},function(t,e,a){a(1),a(0);var i=a(2);if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("barchartstack",{schema:{gridson:{default:!0},xsteps:{default:5},ysteps:{default:5},width:{default:10},height:{default:10},depth:{default:.5},color:{default:"#00FF00"},title:{default:""}},multiple:!1,onDataLoaded:i.onDataLoaded,init:i.default_init,update:i.default_update,initChart:function(){var t=this.el,e=this.data;if(t._data&&0!==t._data.length||t._group){var a;t._data&&t._data.length>0?a=t._data:t._group&&(a=t._group.all()),BAR_WIDTH=e.width/a.length,BAR_DEPTH=e.depth,MAX_HEIGHT=e.height,MAX_VALUE=t._maxfunc(t._group.order(t._maxfunc).top(1)[0].value);var i,n,r;document.createElement("a-entity"),i=BAR_WIDTH/2,n=0,r=e.depth/2;for(var d=0;d<a.length;d++){var s=a[d].value.slice();s.sort(function(t,e){return t.value<e.value?1:t.value>e.value?-1:0});for(var o=0;o<s.length;o++){var l=s[o].value/MAX_VALUE*MAX_HEIGHT,h=function(t,e){return e/2+t}(n,l),u=document.createElement("a-box"),c=t._colors.find(function(t){return t.key===s[o].key}).value,p={x:i,y:h,z:0};u.setAttribute("width",BAR_WIDTH),u.setAttribute("height",l),u.setAttribute("depth",BAR_DEPTH),u.setAttribute("color",c),u.setAttribute("position",p);var f=a[d].value;t._valueHandler&&(f=t._valueHandler(a[d]));var m=a[d].key;t._keyHandler&&(m=t._keyHandler(a[d]));var v={name:"key:"+m+" org:"+s[o].key+" value: "+s[o].value,data:{key:a[d].key,value:f},position:{x:p.x,y:MAX_HEIGHT+.25,z:p.z+r},origin_color:c};u._partData=v,t.appendChild(u);var g=function(t,e){if(t.el._dimension){var a=t.el._dimension;a.filterAll(null),a=a.filter(e.data.key);var i;if(t.el._dashboard?i=t.el._dashboard:t.el._panel&&(i=t.el._panel._dashboard),i)for(var n=i.allCharts(),r=0;r<n.length;r++)n[r]!==t.el&&n[r]._group&&n[r].emit("data-loaded");else for(var d=t.el.parentElement.children,r=0;r<d.length;r++)d[r]!==t.el&&d[r]._group&&d[r].emit("data-loaded");t.el.emit("filtered",{element:e})}},_=g.bind(null,this,u._partData);u.addEventListener("click",_),n+=l}n=0,i+=BAR_WIDTH}this.addEvents(),t._colors&&this.addleyenda();for(var y=this.addYLabels(),A=0;A<y.length;A++)t.appendChild(y[A]);e.gridson&&this.addGrid(),""!==e.title&&this.addTitle()}},addGrid:function(t){var e=document.createElement("a-entity");e.setAttribute("aframe-grid",{height:this.data.height,width:this.data.width,ysteps:this.data.ysteps,xsteps:this.data.xsteps}),e.setAttribute("position",{x:0,y:0,z:-this.data.depth/2}),this.el.appendChild(e)},addTitle:i.addTitle,addEvents:i.addEvents,addYLabels:function(){var t,e,a=this.el;e=this.el._data?this.el._data:this.el._group.top(1/0),t=a._maxfunc(a._group.order(a._maxfunc).top(1)[0].value),e.length;for(var i=t/this.data.ysteps,n=this.data.height/this.data.ysteps,r=[],d=0;d<this.data.ysteps+1;d++)r.push(function(t,e,a){var i=document.createElement("a-entity");TEXT_WIDTH=6;var n=e;i.setAttribute("text",{color:"#000000",side:"double",value:a.toFixed(2),width:TEXT_WIDTH,wrapCount:30,align:"center"});var r={x:-.7,y:n,z:-t.data.depth/2};return i.setAttribute("position",r),i}(this,d*n,d*i));return r},addleyenda:function(){var t=document.createElement("a-entity");t.id="barchart3dleyend";for(var e=this.el._group.top(1)[0],a=this.data.width+.25+1,i=this.data.height-.25,n=0;n<e.value.length;n++){var r=this.el._colors.find(function(t){return t.key===e.value[n].key}).value,d=document.createElement("a-box");d.setAttribute("color",r),d.setAttribute("width",.5),d.setAttribute("height",.5),d.setAttribute("depth",.5),d.setAttribute("position",{x:a,y:i,z:0});var s=document.createElement("a-entity");TEXT_WIDTH=6;var o=e.value[n].key;s.setAttribute("text",{color:"#000000",side:"double",value:o,width:TEXT_WIDTH,wrapCount:30,align:"left"}),s.setAttribute("position",{x:a+1+TEXT_WIDTH/2,y:i,z:0}),t.appendChild(s),t.appendChild(d),i-=.62}this.el.appendChild(t)},remove:function(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild);this.el.innerHTML="",this.el.removeEventListener("data-loaded",this.onDataLoaded.bind(this))},pause:function(){},play:function(){}})},function(t,e,a){a(1),a(3),a(4),a(0);var i=a(2);if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("bubblechart",{schema:{gridson:{default:!0},xsteps:{default:5},ysteps:{default:5},zsteps:{default:10},width:{default:10},height:{default:10},depth:{default:20},color:{default:"#00FF00"},title:{default:""}},multiple:!1,onDataLoaded:i.onDataLoaded,init:i.default_init,update:i.default_update,update:i.default_update,initChart:function(){var t=this.el,e=this.data;if(t._data&&0!==t._data.length||t._group){var a;t._data&&t._data.length>0?a=t._data:t._group&&(a=t._group.all());var i,n,r,d=(e.depth,e.height),s=a.map(function(e){var a=e;return t._arrAccesor(e).map(function(e){return t._heightAccesor(e,a)})}),o=Math.max.apply(null,[].concat.apply([],s));s=a.map(function(e){var a=e;return t._arrAccesor(e).map(function(e){return t._radiusAccesor(e,a)})});var l=Math.max.apply(null,[].concat.apply([],s)),h=t._zAxis,u=Math.min(e.width,e.height,e.depth)/Math.min(a.length,h.length),c=e.depth/h.length,p=e.width/a.length;i=0,n=u,r=-u/2;for(var f=0;f<a.length;f++){for(var m=0;m<h.length;m++){var v=h[m],g=a[f],_=function(t){if(t.key)return t.key===v.key},y=t._arrAccesor(g).find(_);if(y){var A=t._heightAccesor(y,g)/o*d,E=v.value,b=t._radiusAccesor(y,g)/l*u,w={x:i,y:A,z:r},T=document.createElement("a-entity");T.setAttribute("mixin","sph transparente"),T.setAttribute("geometry","radius",b),T.setAttribute("material","color",E),T.setAttribute("position",w),t.appendChild(T);var x=a[f].value;t._valueHandler&&(x=t._valueHandler(y,g));var C=a[f].key;t._keyHandler&&(C=t._keyHandler(g));var H={name:"key:"+C+" value:"+x,data:{key:a[f].key,value:x},position:{x:w.x,y:n+d+.25,z:w.z},origin_color:E};T._partData=H;var R=function(t,e){if(t.el._dimension){var a=t.el._dimension;a.filterAll(null),a=a.filter(e.data.key);var i;if(t.el._dashboard?i=t.el._dashboard:t.el._panel&&(i=t.el._panel._dashboard),i)for(var n=i.allCharts(),r=0;r<n.length;r++)n[r]!==t.el&&n[r]._group&&n[r].emit("data-loaded");else for(var d=t.el.parentElement.children,r=0;r<d.length;r++)d[r]!==t.el&&d[r]._group&&d[r].emit("data-loaded")}t.el.emit("filtered",{element:e})},D=R.bind(null,this,T._partData);T.addEventListener("click",D)}r-=c}r=-u/2,i+=p}this.addEvents();for(var k=this.addYLabels(),L=0;L<k.length;L++)t.appendChild(k[L]);for(var M=this.addZLabels(),L=0;L<M.length;L++)t.appendChild(M[L]);e.gridson&&this.addGrid(),""!==e.title&&this.addTitle()}},addGrid:function(){var t=document.createElement("a-entity");t.setAttribute("aframe-grid",{height:this.data.height,width:this.data.width,ysteps:this.data.ysteps,xsteps:this.data.xsteps}),t.setAttribute("position",{x:0,y:0,z:-this.data.depth}),this.el.appendChild(t);var e=document.createElement("a-entity");e.setAttribute("aframe-gridyz",{height:this.data.height,depth:this.data.depth,ysteps:this.data.ysteps,zsteps:this.el._zAxis.length});var a=document.createElement("a-entity");a.setAttribute("aframe-gridxz",{width:this.data.width,depth:this.data.depth,xsteps:this.data.xsteps,zsteps:this.el._zAxis.length}),this.el.appendChild(e),this.el.appendChild(a)},addYLabels:function(){var t,e,a=this.el;e=this.el._data?this.el._data:this.el._group.top(1/0);var i=e.map(function(t){var e=t;return a._arrAccesor(t).map(function(t){return a._heightAccesor(t,e)})});t=Math.max.apply(null,[].concat.apply([],i));for(var n=t/this.data.ysteps,r=this.data.height/this.data.ysteps,d=[],s=0;s<this.data.ysteps+1;s++)d.push(function(t,e,a){var i=document.createElement("a-entity");TEXT_WIDTH=6;var n=e;i.setAttribute("text",{color:"#000000",side:"double",value:a.toFixed(2),width:TEXT_WIDTH,wrapCount:30,align:"center"});var r={x:-.7,y:n,z:-t.data.depth};return i.setAttribute("position",r),i}(this,s*r,s*n));return d},addZLabels:function(){if(this.el._zAxis){for(var t=this.data.depth/this.el._zAxis.length,e=[],a=0;a<this.el._zAxis.length;a++)e.push(function(t,e,a){var i=document.createElement("a-entity");TEXT_WIDTH=6;var n=-1*(TEXT_WIDTH/2+.7),r=-e;i.setAttribute("text",{color:a.value,side:"double",value:a.key,width:TEXT_WIDTH,wrapCount:30,align:"right"});var d={x:n,y:0,z:r};return i.setAttribute("position",d),i}(0,a*t+t/2,this.el._zAxis[a]));return e}},addTitle:i.addTitle,addEvents:i.addEvents,remove:function(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild);this.el.innerHTML="",this.el.removeEventListener("data-loaded",this.onDataLoaded.bind(this))},pause:function(){},play:function(){}})},function(t,e){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("envmap",{schema:{imgprefix:{default:"img/dawnmountain-"},extension:{default:"png"},width:{default:500},height:{default:500},depth:{default:500}},update:function(){for(var t=this.data.imgprefix,e=["xpos","xneg","ypos","yneg","zpos","zneg"],a="."+this.data.extension,i=new THREE.CubeGeometry(this.data.width,this.data.height,this.data.depth),n=[],r=0;r<6;r++)n.push(new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture(t+e[r]+a),side:THREE.BackSide}));var d=new THREE.MeshFaceMaterial(n),s=new THREE.Mesh(i,d);this.mesh=s,this.el.setObject3D("mesh",this.mesh)}})},function(t,e){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("panel",{schema:{ncolumns:{default:2},nrows:{default:1},margin:{default:6},title:{default:""}},onDataLoaded:function(t){console.log(this.name+":Data Loaded!"),this.reload=!0,this.update(this.data)},init:function(){var t=this,e=this.el;this.initialPositions=[];var a=e.getChildEntities();this.childrenItems=[];for(var i=0;i<a.length;i++)this.childrenItems.push(a[i]);for(var n=0;n<this.childrenItems.length;n++){var r=this.childrenItems[n],d=function(e){var a=e.getAttribute("position");t.initialPositions.push([a.x,a.y,a.z])};if(r.hasLoaded)return d(r);r.addEventListener("loaded",d.bind(null,r))}e.addEventListener("child-attached",this.__childAttachedCallback),e.addEventListener("child-detached",this.__childdetachedCallback),e.addEventListener("data-loaded",this.onDataLoaded.bind(this))},__childAttachedCallback:function(t){t.detail.el.parentNode===this&&"injectedTitle"!==t.detail.el.id&&(this.components.panel.childrenItems.push(t.detail.el),this.emit("data-loaded"))},__childdetachedCallback:function(t){if(-1!==this.components.panel.childrenItems.indexOf(t.detail.el)){var e=this.components.panel.childrenItems.indexOf(t.detail.el);this.components.panel.childrenItems.splice(e,1),this.components.panel.initialPositions.splice(e,1),this.emit("data-loaded")}},update:function(t){if(this.reload){this.reload=!1;for(var e=this.childrenItems,a=this.data,i=(this.el,e.length,a.margin,0),n=this.el.components.geometry.data.height/this.data.nrows,r=this.el.components.geometry.data.width/this.data.ncolumns,d=0,s=!1,o=0;o<this.data.nrows;o++){var l=-this.el.components.geometry.data.height/2+o*n;for(c=0;c<this.data.ncolumns;c++){var h={x:0,y:l,z:0},u=l;if(!this.childrenItems[i])break;var p=this.childrenItems[i],f=function(t){if(!t.hasLoaded)return 1;for(var e=["piechart","barchart","smoothcurvechart","geometry"],a=!1,i=0,n={};!a&&i<e.length;){var r=t.components[e[i]];r&&r.data.depth&&(n.z=r.data.depth,"piechart"===e[i]?(n.x=2*r.data.radius,n.y=2*r.data.radius):(n.x=r.data.width,n.y=r.data.height),a=!0),i++}return n}(p),m=-this.el.components.geometry.data.width/2+c*r;m=s?d:m,s=!1,f.x&&(d=m+f.x+1.3,s=!0),m=m,u=l,h.x=m,h.y=u;var v=f.z/2+.05;h.z=v,p.setAttribute("position",h),i++}if(!this.childrenItems[i])break}}""!==this.data.title&&this.addTitle()},addTitle:function(){var t=document.querySelector("#injectedTitle"),e=this.el.components.geometry.data;if(t)return t.setAttribute("title",{caption:this.data.title,width:e?e.width:6}),void t.setAttribute("position",{x:0,y:2+(e?e.height/2:5),z:0});t=document.createElement("a-entity"),t.id="injectedTitle",t.setAttribute("title",{caption:this.data.title,width:e?e.width:6}),t.setAttribute("position",{x:0,y:2+(e?e.height/2:5),z:0}),this.el.appendChild(t)},remove:function(){this.el.removeEventListener("child-attached",this.__childAttachedCallback),this.el.removeEventListener("child-detached",this.__childdetachedCallback),this.el.removeEventListener("data-loaded",this.onDataLoaded.bind(this))}}),AFRAME.registerPrimitive("a-panel",AFRAME.utils.extendDeep({},AFRAME.primitives.getMeshMixin(),{defaultComponents:{panel:{ncolumns:2,nrows:1},geometry:{primitive:"box",width:20,height:20,depth:.1},material:{color:"gray",opacity:.3,transparent:!0,flatShading:!1}},mappings:{width:"geometry.width",depth:"geometry.depth",nrows:"panel.nrows",ncolumns:"panel.ncolumns"}}))},function(t,e,a){if(a(0),"undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");var i=a(2);AFRAME.registerComponent("piechart",{schema:{radius:{default:2.5},depth:{default:.5},color:{default:"#fff"},title:{default:""}},onDataLoaded:i.onDataLoaded,multiple:!1,init:i.default_init,update:i.default_update,initChart:function(){var t=this.data,e=this.el;if(this.el,e._data&&0!==e._data.length||e._group){var a,i,n=0,r=["#2338D9","#23A2D9","#23D978","#BAD923","#D923D3","#23D7D7","#D72323","#262C07"],d=t.radius;a=d,i=d;var s;s=e._data?e._data:e._group.top(1/0),t.depth;for(var o=function(t,e){return t+e},l=s.map(function(t){return t.value}),h=l.reduce(o,0),l=l.map(function(t){return t/h}),u=0;u<l.length;u++){var c=360*l[u],p=document.createElement("a-cylinder");p.setAttribute("theta-start",n),p.setAttribute("theta-length",c),p.setAttribute("radius",d);var f=n+c/2;f=2*f*Math.PI/360;var m=r[u%r.length];e._colors&&(m=e._colors.find(function(t){return t.key===s[u].key}).value),p.setAttribute("color",m),p.setAttribute("scale",{x:1,y:t.depth,z:1}),p.setAttribute("position",{x:a,y:i,z:0}),p.setAttribute("rotation",{x:-90,y:0,z:0}),n+=c;var v={name:"key:"+s[u].key+" value:"+(100*l[u]).toFixed(3),data:{key:s[u].key,value:s[u].value},position:{x:a,y:i+d+.25,z:t.depth/2},origin_color:m};p._partData=v,e.appendChild(p);var g=function(t,e){if(t.el._dimension){var a=t.el._dimension;a.filterAll(null),a=a.filter(e.data.key);var i;if(t.el._dashboard?i=t.el._dashboard:t.el._panel&&(i=t.el._panel._dashboard),i)for(var n=i.allCharts(),r=0;r<n.length;r++)n[r]!==t.el&&n[r]._group&&n[r].emit("data-loaded");else for(var d=t.el.parentElement.children,r=0;r<d.length;r++)d[r]!==t.el&&d[r]._group&&d[r].emit("data-loaded")}t.el.emit("filtered",{element:e})},_=g.bind(null,this,p._partData);p.addEventListener("click",_)}this.addEvents(),""!==t.title&&this.addTitle()}},addTitle:function(){var t=document.createElement("a-entity");t.setAttribute("title",{caption:this.data.title,width:Math.max(this.data.radius,6)}),t.setAttribute("position",{x:this.data.radius,y:2*this.data.radius+1,z:this.data.depth/2}),this.el.appendChild(t)},addEvents:i.addEvents,remove:function(){for(this.el.removeEventListener("data-loaded",this.onDataLoaded.bind(this));this.el.firstChild;)this.el.removeChild(this.el.firstChild);this.el.innerHTML=""},pause:function(){},play:function(){}})},function(t,e,a){a(1),a(0);var i=a(2);if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("smoothcurvechart",{schema:{gridson:{default:!0},xsteps:{default:5},ysteps:{default:5},width:{default:10},height:{default:10},depth:{default:.5},color:{default:"#00FF00"}},onDataLoaded:i.onDataLoaded,multiple:!1,init:i.default_init,update:i.default_update,initChart:function(){var t=this.el,e=this.data,t=this.el,e=this.data;if(t._data&&0!==t._data.length||t._group){var a,i=function(){var t,e=[];t=Math.max.apply(null,arguments);for(var a=0;a<arguments.length;a++)e.push(arguments[a]/t);return e};t._data&&t._data.length>0?a=t._data:t._group&&(a=t.sortCFData());var n=a.map(function(t){return t.value});COLORS=["#2338D9","#23A2D9","#23D978","#BAD923","#D923D3"],n=i.apply(null,n);for(var r,d=e.width/n.length,s=0,o=new THREE.LineBasicMaterial({color:this.data.color}),l=[],h=0;h<n.length;h++){var u=document.createElement("a-sphere");u.setAttribute("radius",.2),u.setAttribute("color",e.color),l.push(new THREE.Vector3(s,e.height*n[h],0)),u.setAttribute("position",{x:s,y:e.height*n[h],z:.2}),t.appendChild(u);var c={name:"key:"+a[h].key+" value:"+a[h].value,data:{key:a[h].key,value:a[h].value},position:{x:s,y:e.height+.25,z:0},origin_color:e.color};u._partData=c,s+=d}r=new THREE.CatmullRomCurve3(l);var p=new THREE.Geometry;p.vertices=r.getPoints(512);var f=new THREE.Line(p,o);t.setObject3D("mesh",f),this.addEvents(),e.gridson&&this.addGrid()}},addGrid:function(t){var e=document.createElement("a-entity");e.setAttribute("aframe-grid",{height:this.data.height,width:this.data.width,ysteps:this.data.ysteps,xsteps:this.data.xsteps}),e.setAttribute("position",{x:0,y:0,z:-this.data.depth/2}),this.el.appendChild(e)},addTitle:i.addTitle,addEvents:i.addEvents,addYLabels:function(){var t,e,a=this.el;e=this.el._data?this.el._data:this.el._group.top(1/0);var i=e.map(function(t){return a._valueHandler?a._valueHandler(t):t.value});t=Math.max.apply(null,i),i.length;for(var n=t/this.data.ysteps,r=this.data.height/this.data.ysteps,d=[],s=0;s<this.data.ysteps+1;s++)d.push(function(t,e,a){var i=document.createElement("a-entity");TEXT_WIDTH=6;var n=e;i.setAttribute("text",{color:"#000000",side:"double",value:a.toFixed(2),width:TEXT_WIDTH,wrapCount:30,align:"center"});var r={x:-.7,y:n,z:-t.data.depth/2};return i.setAttribute("position",r),i}(this,s*r,s*n));return d},remove:function(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild);this.el.innerHTML="",this.el.removeEventListener("data-loaded",this.onDataLoaded.bind(this))},pause:function(){},play:function(){}})},function(t,e,a){var i=AFRAME.utils.extendDeep;a(1),a(3),a(4),a(6),a(5),a(7),a(8),a(9),a(10),a(12),a(11),a(0),Array.prototype.findIndex||(Array.prototype.findIndex=function(t){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,a=Object(this),i=a.length>>>0,n=arguments[1],r=0;r<i;r++)if(e=a[r],t.call(n,e,r,a))return r;return-1}),Array.prototype.find||(Array.prototype.find=function(t){"use strict";if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,a=Object(this),i=a.length>>>0,n=arguments[1],r=0;r<i;r++)if(e=a[r],t.call(n,e,r,a))return e}),t.exports=function(){var t={version:"0.1.0",DEFAULT_CHART_GROUP:"__defaultgroup__"};t.addDashBoard=function(t){var i=t.canvas,n=function(t){var e=t.querySelector("[camera]");if(e){if(!e.getAttribute("mouse-cursor")){var i=function(){e.setAttribute("mouse-cursor","")};e.hasLoaded?i():e.addEventListener("loaded",i())}}else e=a(),t.appendChild(e)};return i||t.addEventListener("render-target-loaded",n.bind(null,t)),e(t)};var e=function(e){var a=document.createElement("a-entity");a.id="aframedc",e.appendChild(a);var i=a;return i.chartRegistry=function(){function e(e){return e||(e=t.DEFAULT_CHART_GROUP),a[e]||(a[e]=[]),e}var a={};return{register:function(t,i){i=e(i),a[i].push(t)},list:function(t){return t=e(t),a[t]}}}(),i.addPanel=function(t){this.chartRegistry.register(t),t._dashboard=this,this.appendChild(t);for(var e=t.chartRegistry.list(),a=0;a<e.length;a++)t.appendChild(e[a]);return t.render(),this},i.addChart=function(t,e){return this.chartRegistry.register(t),this.appendChild(t),t._dashboard=this,e&&t.setAttribute("position",e),t.render(),this},i.allCharts=function(){for(var t=[],e=this.chartRegistry.list(),a=0;a<e.length;a++)if(e[a].addChart)for(var i=e[a].chartRegistry.list(),n=0;n<i.length;n++)t.push(i[n]);else t.push(e[a]);return t},i},a=function(){var t=document.createElement("a-entity");return t.setAttribute("camera",{}),t.setAttribute("look-controls",{}),t.setAttribute("wasd-controls",{}),t.addEventListener("loaded",function(){t.setAttribute("mouse-cursor","")}),t};t.dashboard=function(t){var i=document.createElement("a-scene");i.setAttribute("embedded",{});var n=a();return i.appendChild(n),t.appendChild(i),e(i)};var n={componentName:"",render:function(){function t(){e.emit("data-loaded")}var e=this;return this.hasLoaded?t():this.addEventListener("loaded",t),this},data:function(t){return this._data=t,this},dimension:function(t){return this._dimension=t,this},group:function(t){return this._group=t,this},depth:function(t){return this.setAttribute(this.componentName,"depth",t),this},color:function(t){return this.setAttribute(this.componentName,"color",t),this},setTitle:function(t){return this.setAttribute(this.componentName,"title",t),this},valueAccessor:function(t){return this._valueHandler=t,this},keyAccessor:function(t){return this._keyHandler=t,this},setId:function(t){return this._id=t,this}};return t.Panel=function(){this.componentName="panel";var e=document.createElement("a-panel"),a=e;return a.chartRegistry=function(){function e(e){return e||(e=t.DEFAULT_CHART_GROUP),a[e]||(a[e]=[]),e}var a={};return{register:function(t,i){i=e(i),a[i].push(t)},list:function(t){return t=e(t),a[t]}}}(),a.render=function(){function t(){e.emit("data-loaded");for(var t=e.chartRegistry.list(),a=0;a<t.length;a++)t[a].render()}var e=this;return this.hasLoaded?t():this.addEventListener("loaded",t),this},a.width=function(t){return this.setAttribute("geometry","width",t),this},a.height=function(t){return this.setAttribute("geometry","height",t),this},a.nrows=function(t){return this.setAttribute(this.componentName,"nrows",t),this},a.ncolumns=function(t){return this.setAttribute(this.componentName,"ncolumns",t),this},a.setTitle=function(t){return this.setAttribute(this.componentName,"title",t),this},a.componentName="panel",a.addChart=function(t){this.chartRegistry.register(t),this._panel=this,a.hasLoaded&&a.sceneEl&&(this.appendChild(t),t.render())},a},t.pieChart=function(){var t=document.createElement("a-entity");t.setAttribute("piechart",{});var e=t;return e=i(e,n),e.componentName="piechart",e.radius=function(t){return this.setAttribute(this.componentName,"radius",t),this},e.color=function(t){return this._colors=t,this},e},t.barChart=function(){var t=document.createElement("a-entity");t.setAttribute("barchart",{});var e=t;return e=i(e,n),e.componentName="barchart",e.width=function(t){return this.setAttribute(this.componentName,"width",t),this},e.height=function(t){return this.setAttribute(this.componentName,"height",t),this},e},t.barChartstack=function(){var t=document.createElement("a-entity");t.setAttribute("barchartstack",{});var e=t;return e=i(e,n),e.componentName="barchartstack",e.width=function(t){return this.setAttribute(this.componentName,"width",t),this},e.height=function(t){return this.setAttribute(this.componentName,"height",t),this},e.orderFunction=function(t){return this._maxfunc=t,this},e.color=function(t){return this._colors=t,this},e},t.bubbleChart=function(){var t=document.createElement("a-entity");t.setAttribute("bubblechart",{});var e=t;return obarChart=i(e,n),e.componentName="bubblechart",e.width=function(t){return this.setAttribute(this.componentName,"width",t),this},e.height=function(t){return this.setAttribute(this.componentName,"height",t),this},e.heightAccessor=function(t){return this._heightAccesor=t,this},e.radiusAccessor=function(t){return this._radiusAccesor=t,this},e.arrayAccessor=function(t){return this._arrAccesor=t,this},e.zAxis=function(t){return this._zAxis=t,this},e},t.barChart3d=function(){var t=document.createElement("a-entity");t.setAttribute("barchart3d",{});var e=t;return e=i(e,n),e.componentName="barchart3d",e.width=function(t){return this.setAttribute(this.componentName,"width",t),this},e.height=function(t){return this.setAttribute(this.componentName,"height",t),this},e.color=function(t){return this._colors=t,this},e.zAxis=function(t){return this._zAxis=t,this},e.transformMethod=function(t){return this._transformFunc=t,this},e},t.smoothCurveChart=function(){var t=document.createElement("a-entity");t.setAttribute("smoothcurvechart",{});var e=t;return e=i(e,n),e.componentName="smoothcurvechart",e.width=function(t){return this.setAttribute(this.componentName,"width",t),this},e.height=function(t){return this.setAttribute(this.componentName,"height",t),this},e.gridsOn=function(t){return this.setAttribute(this.componentName,"gridson",t),this},e},t}()}]);